{"is_source_file": true, "format": "Kotlin", "description": "Source code for PostPlaybackRatingViewModel, an Android ViewModel managing UI state, user interactions, and playback-overlay logic for a post-playback rating overlay in a video app.", "external_files": ["com.example.post_playback_rating_frontend.data.ServiceLocator", "androidx.lifecycle.AndroidViewModel", "androidx.lifecycle.LiveData", "androidx.lifecycle.MutableLiveData", "androidx.lifecycle.viewModelScope", "kotlinx.coroutines.Job", "kotlinx.coroutines.delay", "kotlinx.coroutines.launch", "kotlin.math.max", "kotlin.math.min"], "external_methods": ["ServiceLocator.contentRepository()", "ServiceLocator.metadataRepository()", "ServiceLocator.assetsRepository()", "ServiceLocator.ratingRepository()", "ratingRepo.hasRated()", "ratingRepo.setLike()", "ratingRepo.setRated()", "contentRepo.getContentInfo()", "assetsRepo.getInstructionImages()", "metadataRepo.getVodRatingSettings()"], "published": ["PostPlaybackRatingViewModel.OverlayState", "PostPlaybackRatingViewModel.onCreditsStart", "PostPlaybackRatingViewModel.onPlaybackPositionChanged", "PostPlaybackRatingViewModel.onDurationChanged", "PostPlaybackRatingViewModel.onEndReached", "PostPlaybackRatingViewModel.onClosePressed", "PostPlaybackRatingViewModel.onLike", "PostPlaybackRatingViewModel.onLove", "PostPlaybackRatingViewModel.onDislike", "PostPlaybackRatingViewModel.hideOverlay"], "classes": [{"name": "PostPlaybackRatingViewModel", "description": "Android ViewModel managing UI state and user interactions for a post-playback rating overlay, including countdown logic, rating persistence, and overlay visibility control."}, {"name": "OverlayState", "description": "Sealed class representing various UI states of the rating overlay, including visibility, loading, auto-closing, and navigation states."}], "methods": [{"name": "onCreditsStart", "description": "Triggered when credits start, checks if overlay should be shown, and displays it if appropriate."}, {"name": "onPlaybackPositionChanged", "description": "Updates current playback position; used to detect rewind before credits to allow re-show."}, {"name": "onDurationChanged", "description": "Updates the video content duration."}, {"name": "onEndReached", "description": "Marks that the playback has reached its end, influencing auto-close behavior."}, {"name": "onClosePressed", "description": "Handles user pressing the close button, cancels countdown, and updates state."}, {"name": "onLike", "description": "Handles user selecting 'Like' rating."}, {"name": "onLove", "description": "Handles user selecting 'Love' rating."}, {"name": "onDislike", "description": "Handles user selecting 'Dislike' rating."}, {"name": "hideOverlay", "description": "Host can call to hide the overlay, e.g., navigating away."}], "calls": ["ratingRepo.hasRated", "contentRepo.getContentInfo", "assetsRepo.getInstructionImages", "metadataRepo.getVodRatingSettings"], "search-terms": ["PostPlaybackRatingViewModel", "OverlayState", "ratings", "post-playback", "credits", "auto-close", "countdown", "player hooks", "overlay visibility", "rating persistence"], "state": 2, "file_id": 32, "knowledge_revision": 213, "git_revision": "78e59d59cf7bd385473fd9df5c18d3d097992efa", "revision_history": [{"92": ""}, {"178": "5bfdd06a5106031bd12fb1327e62708b507f181c"}, {"179": "5bfdd06a5106031bd12fb1327e62708b507f181c"}, {"180": "5bfdd06a5106031bd12fb1327e62708b507f181c"}, {"213": "78e59d59cf7bd385473fd9df5c18d3d097992efa"}], "hash": "62c64f3385cd97e2e13b51339babb99b", "format-version": 4, "code-base-name": "post_playback_rating_frontend", "filename": "post_playback_rating_frontend/app/src/main/java/com/example/post_playback_rating_frontend/rating/PostPlaybackRatingViewModel.kt"}