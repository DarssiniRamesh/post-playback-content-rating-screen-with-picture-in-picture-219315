{"is_source_file": true, "format": "Kotlin", "description": "This is a complete source file for a ViewModel class `PostPlaybackRatingViewModel` used in an Android application. The class manages the UI state for a post-playback rating overlay, handling interactions, countdown timers, and state transitions related to user ratings and content metadata.", "external_files": ["com.example.post_playback_rating_frontend.data.ServiceLocator", "android.app.Application", "androidx.lifecycle.AndroidViewModel", "androidx.lifecycle.LiveData", "androidx.lifecycle.MutableLiveData", "androidx.lifecycle.viewModelScope", "kotlinx.coroutines.Job", "kotlinx.coroutines.delay", "kotlinx.coroutines.launch", "kotlin.math.max", "kotlin.math.min"], "external_methods": ["ServiceLocator.contentRepository()", "ServiceLocator.metadataRepository()", "ServiceLocator.assetsRepository()", "ServiceLocator.ratingRepository()", "ratingRepo.hasRated()", "ratingRepo.setLike()", "ratingRepo.setRated()", "metadataRepo.getIndiceCopy()", "assetsRepo.getInstructionImages()"], "published": ["PostPlaybackRatingViewModel", "OverlayState"], "classes": [{"name": "PostPlaybackRatingViewModel", "description": "A ViewModel class managing the post-playback rating overlay, including UI state, timers, and user interactions."}], "methods": [{"name": "onCreditsStart", "description": "Triggered when the credits start, possibly to show the overlay."}, {"name": "onPlaybackPositionChanged", "description": "Updates the current playback position, used to reset or trigger overlay display logic."}, {"name": "onDurationChanged", "description": "Updates the total duration of playback."}, {"name": "onEndReached", "description": "Indicates that the playback has reached the end."}, {"name": "onClosePressed", "description": "Handles user action to close the overlay without rating."}, {"name": "onLike", "description": "Handles user liking the content."}, {"name": "onLove", "description": "Handles user expressing love for the content."}, {"name": "onDislike", "description": "Handles user disliking the content."}, {"name": "handleRatingSelection", "description": "Processes the user's rating selection."}, {"name": "shouldShowOverlay", "description": "Determines whether to display the overlay based on user rating history and state."}, {"name": "showOverlayInternal", "description": "Prepares and displays the overlay, starting the countdown timer."}, {"name": "startCountdown", "description": "Initiates the countdown timer for auto-closing the overlay."}, {"name": "cancelCountdown", "description": "Cancels the running countdown timer."}, {"name": "handleCountdownFinished", "description": "Handles actions when countdown reaches zero, such as navigating away."}, {"name": "hideOverlay", "description": "Host can externally force hide the overlay."}], "calls": ["ServiceLocator.contentRepository()", "ServiceLocator.metadataRepository()", "ServiceLocator.assetsRepository()", "ServiceLocator.ratingRepository()", "ratingRepo.hasRated()", "ratingRepo.setLike()", "ratingRepo.setRated()", "metadataRepo.getIndiceCopy()", "assetsRepo.getInstructionImages()", "viewModelScope.launch", "delay", "viewModelScope.launch", "viewModelScope.launch", "viewModelScope.launch", "viewModelScope.launch", "viewModelScope.launch", "viewModelScope.launch", "viewModelScope.launch", "viewModelScope.launch"], "search-terms": ["PostPlaybackRatingViewModel", "OverlayState", "credits start", "auto-close", "rating", "content id", "countdown timer", "UI state", "AndroidViewModel", "post-playback"], "state": 2, "file_id": 32, "knowledge_revision": 180, "git_revision": "5bfdd06a5106031bd12fb1327e62708b507f181c", "revision_history": [{"92": ""}, {"178": "5bfdd06a5106031bd12fb1327e62708b507f181c"}, {"179": "5bfdd06a5106031bd12fb1327e62708b507f181c"}, {"180": "5bfdd06a5106031bd12fb1327e62708b507f181c"}], "hash": "4c18774869c515e3a14497f0def06fe7", "format-version": 4, "code-base-name": "post_playback_rating_frontend", "filename": "post_playback_rating_frontend/app/src/main/java/com/example/post_playback_rating_frontend/rating/PostPlaybackRatingViewModel.kt"}