{"is_source_file": true, "format": "Kotlin", "description": "This Kotlin file defines the PostPlaybackRatingViewModel class, which manages the UI state and logic for a post-playback rating overlay in an Android application. It handles showing/hiding the overlay, countdown timers, user interaction (like, love, dislike, close), and auto-navigation after auto-close conditions.", "external_files": ["com.example.post_playback_rating_frontend.data.ServiceLocator", "kotlinx.coroutines.Job", "kotlinx.coroutines.delay", "kotlinx.coroutines.launch", "androidx.lifecycle.AndroidViewModel", "androidx.lifecycle.LiveData", "androidx.lifecycle.MutableLiveData", "androidx.lifecycle.viewModelScope", "android.app.Application"], "external_methods": ["ServiceLocator.contentRepository()", "ServiceLocator.metadataRepository()", "ServiceLocator.assetsRepository()", "ServiceLocator.ratingRepository()", "metadataRepo.getIndiceCopy()", "ratingRepo.setLike()"], "published": ["PostPlaybackRatingViewModel", "OverlayState"], "classes": [{"name": "PostPlaybackRatingViewModel", "description": "ViewModel managing the post-playback rating overlay, including state transitions, countdown timers, and user interactions."}], "methods": [{"name": "onCreditsStart", "description": "Triggers overlay display when credits start, based on current playback position."}, {"name": "onPlaybackPositionChanged", "description": "Updates playback position; re-show overlay if rewind occurs before credits."}, {"name": "onDurationChanged", "description": "Updates current playback duration."}, {"name": "onEndReached", "description": "Signals that playback has reached end; used to determine navigation after auto-close."}, {"name": "onClosePressed", "description": "Handles user pressing close button, cancels countdown, and updates state."}, {"name": "onLike", "description": "Handles user selecting 'Like' rating."}, {"name": "onLove", "description": "Handles user selecting 'Love' rating."}, {"name": "onDislike", "description": "Handles user selecting 'Dislike' rating."}, {"name": "handleRatingSelection", "description": "Updates rating state and closes overlay after user interaction."}, {"name": "shouldShowOverlay", "description": "Determines whether overlay should be shown based on previous user actions."}, {"name": "showOverlayInternal", "description": "Sets overlay to visible, initializes content, and starts countdown timer."}, {"name": "startCountdown", "description": "Begins the countdown timer, updating UI each second."}, {"name": "cancelCountdown", "description": "Stops the countdown timer if active."}, {"name": "handleCountdownFinished", "description": "Handles logic after countdown: auto-close and potential navigation."}, {"name": "hideOverlay", "description": "Hides the overlay externally, e.g., when navigating away."}], "calls": ["metadataRepo.getIndiceCopy()", "assetsRepo.getInstructionImages().mainPreview", "ratingRepo.setLike()"], "search-terms": ["PostPlaybackRatingViewModel", "OverlayState", "post_playback", "rating overlay", "auto-close countdown", "player hooks", "credits start", "user rating"], "state": 2, "file_id": 32, "knowledge_revision": 92, "git_revision": "", "hash": "b15c094974194a09faa059b0c93c91c0", "format-version": 4, "code-base-name": "post_playback_rating_frontend", "filename": "post_playback_rating_frontend/app/src/main/java/com/example/post_playback_rating_frontend/rating/PostPlaybackRatingViewModel.kt", "revision_history": [{"92": ""}]}